<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AgeStrucNe: agestrucne.pgparallelopmanager Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AgeStrucNe
   </div>
   <div id="projectbrief">GUI Front end with refactoring of population genetics programming provided by Tiago Antao&#39;s AgeStructureNe code, with enhanced subsampling, simulation parameterization, and plotting.  We have several outside dependancies (chiefly simuPop and LDNe2)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>agestrucne</b></li><li class="navelem"><a class="el" href="namespaceagestrucne_1_1pgparallelopmanager.html">pgparallelopmanager</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">agestrucne.pgparallelopmanager Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8100e801d32d6ecbb4e5bc2210d42022"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceagestrucne_1_1pgparallelopmanager.html#a8100e801d32d6ecbb4e5bc2210d42022">prep_and_call_do_pgopsimupop_replicate</a> (s_config_file, s_life_table_files, s_param_file, s_output_base_name, s_replicate_number, s_use_gui_messaging=&quot;True&quot;, s_output_mode=str(pgsim.PGOpSimuPop.OUTPUT_GENEPOP_ONLY))</td></tr>
<tr class="separator:a8100e801d32d6ecbb4e5bc2210d42022"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad625c5f1bf0d410a2cd484c041cb3ab1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceagestrucne_1_1pgparallelopmanager.html#ad625c5f1bf0d410a2cd484c041cb3ab1">do_pgopsimupop_replicate_from_files</a> (s_configuration_file, ls_life_table_files, s_param_name_file, s_outfile_basename, i_replicate_number, b_use_gui_messaging=True, i_output_mode=pgsim.PGOpSimuPop.OUTPUT_GENEPOP_ONLY)</td></tr>
<tr class="separator:ad625c5f1bf0d410a2cd484c041cb3ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af80bfd5ff8a36a2fbfe66f8762cfe4f2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceagestrucne_1_1pgparallelopmanager.html#af80bfd5ff8a36a2fbfe66f8762cfe4f2">do_simulation_reps_in_subprocesses</a> (o_multiprocessing_event, i_input_reps, i_total_processes_for_sims, s_temp_config_file_for_running_replicates, ls_life_table_files, s_param_names_file, s_output_basename, b_use_gui_messaging=True, i_output_mode=pgsim.PGOpSimuPop.OUTPUT_GENEPOP_ONLY)</td></tr>
<tr class="separator:af80bfd5ff8a36a2fbfe66f8762cfe4f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b8e5b2e4146c4125cb06eb6aa8e5260"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceagestrucne_1_1pgparallelopmanager.html#a1b8e5b2e4146c4125cb06eb6aa8e5260">remove_simulation_replicate_output_files</a> (s_basename)</td></tr>
<tr class="separator:a1b8e5b2e4146c4125cb06eb6aa8e5260"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa1940257344bbb2de7b4fec52fb426bd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa1940257344bbb2de7b4fec52fb426bd"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>VERBOSE</b> = False</td></tr>
<tr class="separator:aa1940257344bbb2de7b4fec52fb426bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Description
2017_11_12.  In order to resolve the circular import statements that
surfaced when I packaged the modules inside the agestrune subdirectory,
I've moved these defs from pgutilitiies.  In the older state, these required
that pgutilitites imports several of the pg modules, at least one of which
imports pgutilitities.  

This module's name pgparallelopmanager.py suggests it should manage
all of the ops (simulation, LDNe, and Viz), but for now only
has those defs which needed to be moved to solve  the import 
curcularity problem.  As such, pgutilities still has defs that
instantiate new processes for LDNe and Viz ops.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad625c5f1bf0d410a2cd484c041cb3ab1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def agestrucne.pgparallelopmanager.do_pgopsimupop_replicate_from_files </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_configuration_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ls_life_table_files</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_param_name_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_outfile_basename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i_replicate_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b_use_gui_messaging</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i_output_mode</em> = <code>pgsim.PGOpSimuPop.OUTPUT_GENEPOP_ONLY</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">necessitated by fact that python2 (and 3?) was not able to pickle a
class-instance def to be used to run replicates of the pgopsimupop doOp().
Python also failed to pickle SWIG-based code used in Simupop.  Thus the
better design, in which  multiprocessing Pools would stay  encapsulated
inside a class object seem problematic, though may be implement-able using
reg_copy -- but I'm not confident in state of regcopy of imported simuPop
code, and so  I think is the safer solution, though it does create a
depandancy of the pgguisimupop object on this outside def.  

Note that this def runs a simupop operation using all the param values as
given in the config file arg, except for the "reps" attribute, with is reset to 1,
whatever the value in the configuration file.

Tue Jul 26 22:01:07 MDT 2016 updated to be called by a driver that creates
a new OS process, then calls this def to do the replicate.  No longer uses
the dv_input_parm_values_by_attribute, but instead relies on reading a
complete and up-to-date (i.e. all values as changed or edited on the gui
interface) configuration files (that includes the "life table" params).

2017_05_30. Added def param b_use_gui_messaging with default value True, to
accomodate new module pgdrivesimulation.py which needs to call with False,
to avoid gui messaging in a server setting.
</pre> 
<p>Definition at line <a class="el" href="pgparallelopmanager_8py_source.html#l00092">92</a> of file <a class="el" href="pgparallelopmanager_8py_source.html">pgparallelopmanager.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="namespaceagestrucne_1_1pgparallelopmanager.html#ad625c5f1bf0d410a2cd484c041cb3ab1">   92</a></span>&#160;                                                i_output_mode=pgsim.PGOpSimuPop.OUTPUT_GENEPOP_ONLY ):</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral">    necessitated by fact that python2 (and 3?) was not able to pickle a</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral">    class-instance def to be used to run replicates of the pgopsimupop doOp().</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="stringliteral">    Python also failed to pickle SWIG-based code used in Simupop.  Thus the</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral">    better design, in which  multiprocessing Pools would stay  encapsulated</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">    inside a class object seem problematic, though may be implement-able using</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">    reg_copy -- but I&#39;m not confident in state of regcopy of imported simuPop</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">    code, and so  I think is the safer solution, though it does create a</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="stringliteral">    depandancy of the pgguisimupop object on this outside def.  </span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="stringliteral">    Note that this def runs a simupop operation using all the param values as</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="stringliteral">    given in the config file arg, except for the &quot;reps&quot; attribute, with is reset to 1,</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="stringliteral">    whatever the value in the configuration file.</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="stringliteral">    Tue Jul 26 22:01:07 MDT 2016 updated to be called by a driver that creates</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="stringliteral">    a new OS process, then calls this def to do the replicate.  No longer uses</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="stringliteral">    the dv_input_parm_values_by_attribute, but instead relies on reading a</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="stringliteral">    complete and up-to-date (i.e. all values as changed or edited on the gui</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="stringliteral">    interface) configuration files (that includes the &quot;life table&quot; params).</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="stringliteral">    2017_05_30. Added def param b_use_gui_messaging with default value True, to</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="stringliteral">    accomodate new module pgdrivesimulation.py which needs to call with False,</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="stringliteral">    to avoid gui messaging in a server setting.</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    s_tag_out=<span class="stringliteral">&quot;&quot;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    NUMBER_FIRST_REPLICATE=1</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="stringliteral">    2018_04_05. For some of the testing and figures used in the manuscript for</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="stringliteral">    the program note, we set this to True, and for each pop output, we get the</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="stringliteral">    pwop-based Nb value for the pop written to a file, and we also get the</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="stringliteral">    totals for each age class written to a file.  If set to False, the default</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="stringliteral">    behavior is to write these files only for replicate 1</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="stringliteral">    of the simulation.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    ALWAYS_WRITE_NB_AND_AGE_TABLES=<span class="keyword">False</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="stringliteral">    As of 2016_08_23 the *sim, *gen, *db files</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="stringliteral">    are not used, and clutter up the output directories,</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="stringliteral">    per other users comments</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">#whether or not to remove the *sim *gen *db</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">#files (original output from Tiago&#39;s code ), </span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">#which leaves only a *conf and *genepop</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">#files as output</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    REMOVE_NON_GENEPOP_SIM_OUTPUT_FILES=<span class="keyword">True</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> i_replicate_number <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        s_tag_out=pgut.SIMULATION_OUTPUT_FILE_REPLICATE_TAG + str( i_replicate_number )</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">#end if rep number is not none</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="stringliteral">    2017_05_30.  To allow no life table, as implemented  in the new module</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="stringliteral">    pgdrivesimulation.py, we set the resources object to None, then test for </span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="stringliteral">    a life table name not equal to &quot;none.&quot;  If found, then we </span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="stringliteral">    create a resource object.  Otherwise, pass it as None to the input object.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    o_resources=<span class="keywordtype">None</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> ls_life_table_files != [ <span class="stringliteral">&quot;none&quot;</span> ]:</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        o_resources=pgrec.PGSimuPopResources( ls_life_table_files )</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">#end if we have life tables</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    o_paramset=pgpar.PGParamSet( s_param_name_file )</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    o_input=pgin.PGInputSimuPop( s_configuration_file, o_resources, o_paramset ) </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    </div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    o_input.makeInputConfig()</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    </div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    b_write_conf_file=<span class="keyword">False</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="stringliteral">    2018_05_09. Renamed from b_write_nb_and_age_tables:</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    b_write_the_once_only_files=<span class="keyword">False</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">#we only write the configuraton file if the replicate number is 1:</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> i_replicate_number == NUMBER_FIRST_REPLICATE:</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        b_write_conf_file=<span class="keyword">True</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">#end if first replicate number</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="stringliteral">    2017_04_07.  These are files that, as the sim proceeds,</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="stringliteral">    write two tables, one giving the pwop Nb values, the </span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="stringliteral">    other giving a per-age cound of individuals for each pop.</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="stringliteral">    These were intitially temporoary included files for testing,</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="stringliteral">    but are useful enought to warrant inclusion in the output,</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="stringliteral">    at least for the first replicate.</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="stringliteral">    2018_04_01.  We move the setting of the b_write_the_once_only_files</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="stringliteral">    flag from the above test to write the conf file, to the following,</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="stringliteral">    so that we can write them for every replicate just by setting the</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="stringliteral">    constant in this def:</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span> i_replicate_number == NUMBER_FIRST_REPLICATE \</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordflow">or</span> ALWAYS_WRITE_NB_AND_AGE_TABLES==<span class="keyword">True</span>:</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        b_write_the_once_only_files=<span class="keyword">True</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">#end if we should wtie nb and age tables    </span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">#reset reps to 1</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">#as we are executing only one</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">#replicate.  We assume this def</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">#is being called as one of a number</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">#of parallel process calls for</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">#a set of replicates, the total </span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">#known to the caller:</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    o_input.reps=1</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    o_output=pgout.PGOutputSimuPop( s_outfile_basename )</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="stringliteral">    2017_03_26. Note the added param in the init of</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="stringliteral">    the PGOpSimuPop object.  Module pgopsimupop now has a mod-level def</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="stringliteral">    to import and the pgguiutilities.PGGUI* classes and </span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="stringliteral">    set a flag so that exeptions and other info during the</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="stringliteral">    simulation will raise a message window.  Note that </span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="stringliteral">    when I tried to make the import of the PGGUI* message</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="stringliteral">    classed the default for pgopsimupop.py, then an import</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="stringliteral">    error was raised when I tried to start the main program</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="stringliteral">    (negui.py).  There must be some recursive import problem.</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="stringliteral">    Note that the import works file in this context, when</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="stringliteral">    the pgopsimupop.py module is imported in this separate</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="stringliteral">    python instance.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="stringliteral">    2017_06_11. Note we have added a new parameter, b_is_replicate_1,</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="stringliteral">    to tell the pgopsimupop instance that it is the first replicate.</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="stringliteral">    This limits the number of warning gui&#39;s it will produce to one,</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="stringliteral">    about presence of lamba value in conf being unused (see __init__</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="stringliteral">    in pgopsimupop.py).</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    o_new_pgopsimupop_instance=pgsim.PGOpSimuPop( o_input,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            o_output, </div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            b_remove_db_gen_sim_files=REMOVE_NON_GENEPOP_SIM_OUTPUT_FILES,</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            b_write_input_as_config_file=b_write_conf_file,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            b_do_gui_messaging=b_use_gui_messaging,</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            b_write_the_once_only_files=b_write_the_once_only_files,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            b_is_replicate_1 = ( i_replicate_number == 1 ),</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            i_output_mode=i_output_mode )</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    o_new_pgopsimupop_instance.prepareOp( s_tag_out  )</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    o_new_pgopsimupop_instance.doOp()</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">#end do_pgopsimupop_replicate_from_files</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af80bfd5ff8a36a2fbfe66f8762cfe4f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def agestrucne.pgparallelopmanager.do_simulation_reps_in_subprocesses </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>o_multiprocessing_event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i_input_reps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i_total_processes_for_sims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_temp_config_file_for_running_replicates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ls_life_table_files</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_param_names_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_output_basename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b_use_gui_messaging</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i_output_mode</em> = <code>pgsim.PGOpSimuPop.OUTPUT_GENEPOP_ONLY</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Failed to get independant initialization of population per-replicate
when i used python's multiprocessing.process objects as hosts for 
running replicates in parallel.  Solution as of now, 
Sat Jul 30 22:38:42 MDT 2016, is to use OS processes via python's 
subprocess module, creating them in this def, which gets its
requisite info needed for the sim from the pgguisimupop instance
that calls this def (this def is called by the GUI interface instance
in a new python.multiprocessing.process instance, in order not to block the gui).

Note that this def was originally inside the pgguisimupop instance that calls it,
but on windows there was a pickling error not seen on linux or Mac.  Moving this
target def for the python.multiprocessing.process outside the pgguisimupop instance
seems to have solved the problem on windows (win 10).

This def manages the replices via creating subprocesses, and 
calling pgparallelopmanager.prep_and_call_do_pgopsimupop_replicate 
(note: the call has been updated  2017_11_12, after the defs were
moved from pgutilities into new module pgparallelopmanager.

2017_05_30.  We added the def param b_use_gui_messaging=True, to allow
this def to be called from a command line implentation (new module 
pgdrivesimulation.py), and set the flag to false, without having to
revise the call from the GUI pgguisimupop.py.</pre> 
<p>Definition at line <a class="el" href="pgparallelopmanager_8py_source.html#l00253">253</a> of file <a class="el" href="pgparallelopmanager_8py_source.html">pgparallelopmanager.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="namespaceagestrucne_1_1pgparallelopmanager.html#af80bfd5ff8a36a2fbfe66f8762cfe4f2">  253</a></span>&#160;                                        i_output_mode=pgsim.PGOpSimuPop.OUTPUT_GENEPOP_ONLY ):</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="stringliteral">    Failed to get independant initialization of population per-replicate</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="stringliteral">    when i used python&#39;s multiprocessing.process objects as hosts for </span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="stringliteral">    running replicates in parallel.  Solution as of now, </span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="stringliteral">    Sat Jul 30 22:38:42 MDT 2016, is to use OS processes via python&#39;s </span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="stringliteral">    subprocess module, creating them in this def, which gets its</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="stringliteral">    requisite info needed for the sim from the pgguisimupop instance</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="stringliteral">    that calls this def (this def is called by the GUI interface instance</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="stringliteral">    in a new python.multiprocessing.process instance, in order not to block the gui).</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="stringliteral">    Note that this def was originally inside the pgguisimupop instance that calls it,</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="stringliteral">    but on windows there was a pickling error not seen on linux or Mac.  Moving this</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="stringliteral">    target def for the python.multiprocessing.process outside the pgguisimupop instance</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="stringliteral">    seems to have solved the problem on windows (win 10).</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="stringliteral">    This def manages the replices via creating subprocesses, and </span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="stringliteral">    calling pgparallelopmanager.prep_and_call_do_pgopsimupop_replicate </span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="stringliteral">    (note: the call has been updated  2017_11_12, after the defs were</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="stringliteral">    moved from pgutilities into new module pgparallelopmanager.</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="stringliteral">    2017_05_30.  We added the def param b_use_gui_messaging=True, to allow</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="stringliteral">    this def to be called from a command line implentation (new module </span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="stringliteral">    pgdrivesimulation.py), and set the flag to false, without having to</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="stringliteral">    revise the call from the GUI pgguisimupop.py.</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span> </div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="stringliteral">&#39;&#39;&#39; </span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="stringliteral">    Running this inside a try block allows us to notify GUI</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="stringliteral">    users of exceptions propogated from anywere inside the </span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="stringliteral">    simulation setup and execution code. When we catch exceptions </span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="stringliteral">    below, we send an error message to a gui message box, then</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="stringliteral">    re-raise the exception. </span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="stringliteral">     </span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="stringliteral">    2017_08_07.  I&#39;ve added the params i_output_mode and s_pop_het_filter_string,</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="stringliteral">    to allow callers to this def to set these new parameters in the PGOpSimuPop</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="stringliteral">    object.</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        s_life_tables_stringified=<span class="stringliteral">&quot;,&quot;</span>.join( ls_life_table_files )</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">#if we&#39;re on windows, out strings of file</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">#paths may be a mangled mix of unix and </span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">#windows separators -- with errors resulting</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">#downstream.  So we standardize:</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">if</span> pgut.is_windows_platform():</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            s_life_tables_stringified= \</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                pgut.fix_windows_path( s_life_tables_stringified )</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            s_param_names_file= \</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                pgut.fix_windows_path( s_param_names_file )             </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            s_output_basename= \</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                pgut.fix_windows_path( s_output_basename )  </div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">#end if windows, fix file path strings</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        i_total_replicates_requested=i_input_reps</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        i_max_processes_to_use=i_total_processes_for_sims</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="stringliteral">        we use a python command for a -c arg in the Popen command (see below)</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="stringliteral">        and these will be the same args for each replicate (we add the rep-number</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="stringliteral">        arg below).  We stringify so that they can be Popen command args.  Some</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="stringliteral">        are de-stringified by the pgparallelopmanager (formerly in pgutilities)</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="stringliteral">        def before sending to pgop-creator.</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="stringliteral">        &#39;&#39;&#39;</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        seq_first_four_args_to_sim_call=( s_temp_config_file_for_running_replicates,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                        s_life_tables_stringified,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                        s_param_names_file,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                        s_output_basename )</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        </div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        i_total_replicates_started=0</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        o_subprocess_group=<a class="code" href="classagestrucne_1_1pgutilityclasses_1_1IndependantSubprocessGroup.html">IndependantSubprocessGroup</a>()</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">while</span> i_total_replicates_started &lt; i_total_replicates_requested:</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="comment">#see if we need to cancel:  </span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">if</span> o_multiprocessing_event.is_set():</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="keywordflow">if</span> VERBOSE:</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    <span class="keywordflow">print</span> ( <span class="stringliteral">&quot;received event in setup loop&quot;</span> )</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <span class="comment">#end if VERBOSE</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                o_subprocess_group.terminateAllSubprocesses()</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            </div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <a class="code" href="namespaceagestrucne_1_1pgparallelopmanager.html#a1b8e5b2e4146c4125cb06eb6aa8e5260">remove_simulation_replicate_output_files</a>( s_output_basename )</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                <span class="keywordflow">break</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                i_number_subprocesses_alive=o_subprocess_group.getTotalAlive()</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                i_number_subprocesses_available= \</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                        i_max_processes_to_use-i_number_subprocesses_alive</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                i_number_replicates_to_go=i_total_replicates_requested - i_total_replicates_started</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                i_number_subprocesses_to_start=i_number_subprocesses_available</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="comment">#reduce the number to start if we have fewer reps to go than avail procs:</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keywordflow">if</span> i_number_subprocesses_available &gt; i_number_replicates_to_go:</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                        i_number_subprocesses_to_start = i_number_replicates_to_go</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="comment">#end if fewer needed than available</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> range( i_number_subprocesses_to_start ):</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    i_total_replicates_started += 1</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                </div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="stringliteral">                    In the Popen call, rather than rely on a driver python script </span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="stringliteral">                    that would need to be in PATH, we&#39;ll simply</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="stringliteral">                    invoke python with a &quot;-c&quot; argument that imports the </span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="stringliteral">                    pgparallelopmanager (formerly code was in pgutilities)</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="stringliteral">                    module and executes the correct def:</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="stringliteral">            </span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="stringliteral">                    complete the set of args used in the command by adding the</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="stringliteral">                    replicate number (recall need comma in sequence with single item,</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="stringliteral">                    to delineate sequence versus simple expression):</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="stringliteral">                    &#39;&#39;&#39;</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    seq_complete_arg_set=seq_first_four_args_to_sim_call + ( str( i_total_replicates_started ), )</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="stringliteral">                    2017_05_30.  We added this argument to def prep_and_call_do_pgopsimupop_replicate, to propgate</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="stringliteral">                    to its call to def do_pgopsimupop_replicate_from_files.</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="stringliteral">                    </span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="stringliteral">                    &#39;&#39;&#39;</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    seq_complete_arg_set=seq_complete_arg_set + ( str( b_use_gui_messaging ), )</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="stringliteral">                    2017_08_07.  We added args to allow caller to use diffeent output modes, </span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="stringliteral">                    and, if using the filter output mode, to pass a string with parameters,</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="stringliteral">                    for filtering pops by mean heterozygosity.  (See new additions to PGOpSimuPop code.)</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="stringliteral">                    2017_09_04. We remove the s_pop_het_filter_string argument.  It has been removed from</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="stringliteral">                    the arglist for initializing PGOpSimuPop instances, and instead those instances</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="stringliteral">                    will access it directly from the PGInputSimuPop object.</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="stringliteral">                    &#39;&#39;&#39;</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    seq_complete_arg_set=seq_complete_arg_set + ( str( i_output_mode ), )</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="stringliteral">                    in case the negui mods are not in the default python </span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="stringliteral">                    install dirs, then we need to add them to the sys.paths in</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="stringliteral">                    any  spawned invocation of python exe -- seems that </span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="stringliteral">                    the PYTHONPATH env var known to this parent process </span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="stringliteral">                    is unknown to the &quot;python&quot; invocation via Popen.  </span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="stringliteral">                    We can get for and then add to our new python invocation</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="stringliteral">                    the path to all negui modules by getting the</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="stringliteral">                    path to this module:</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="stringliteral">                    &#39;&#39;&#39;</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    s_curr_mod_path = os.path.abspath(__file__)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    <span class="comment">#path only (stripped off &quot;/utilities.py&quot; )</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    <span class="comment">#-- gives path to all negui mods:</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    s_mod_dir=os.path.dirname( s_curr_mod_path )</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    <span class="comment">#need to fix the path if we&#39;re on windows:</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    <span class="keywordflow">if</span> pgut.is_windows_platform():</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        s_mod_dir=pgut.fix_windows_path( s_mod_dir )</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    <span class="comment">#end if windows, fix path</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    </div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    s_path_append_statements=<span class="stringliteral">&quot;import sys; sys.path.append( \&quot;&quot;</span> \</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                            + s_mod_dir + <span class="stringliteral">&quot;\&quot; );&quot;</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="stringliteral">                    2017_11_12. The path statements used import pgutilities, but now we</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="stringliteral">                    are using this new module pgparallelopmanager.</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="stringliteral">                    &#39;&#39;&#39;</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    s_python_command=s_path_append_statements + <span class="stringliteral">&quot;import pgparallelopmanager as pgpar;&quot;</span> \</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                        <span class="stringliteral">&quot;pgpar.prep_and_call_do_pgopsimupop_replicate&quot;</span> \</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                        + <span class="stringliteral">&quot;( \&quot;%s\&quot;, \&quot;%s\&quot;, \&quot;%s\&quot;, \&quot;%s\&quot;, \&quot;%s\&quot;, \&quot;%s\&quot;, \&quot;%s\&quot; )&quot;</span> %  seq_complete_arg_set</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    o_new_subprocess=subprocess.Popen( [ pgut.PYEXE_FOR_POPEN, <span class="stringliteral">&quot;-c&quot;</span>, s_python_command ] )</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    o_subprocess_group.addSubprocess( o_new_subprocess ) </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="comment">#end for each idx of new procs</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="comment">#end if event is set else not</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="comment">#end while preplicates need to be started</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">#we don&#39;t want to return until all processes are done.</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="comment">#meantime test for cancel-request</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        i_total_still_alive_after_creating_all=o_subprocess_group.getTotalAlive()</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">while</span> i_total_still_alive_after_creating_all &gt; 0:</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">if</span> o_multiprocessing_event.is_set():</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="keywordflow">if</span> VERBOSE:</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                    print( <span class="stringliteral">&quot;received event in final loop&quot;</span> )</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                <span class="comment">#end if verbose</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                o_subprocess_group.terminateAllSubprocesses()</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <a class="code" href="namespaceagestrucne_1_1pgparallelopmanager.html#a1b8e5b2e4146c4125cb06eb6aa8e5260">remove_simulation_replicate_output_files</a>( s_output_basename )</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="comment">#end if we are to cancel</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            i_total_still_alive_after_creating_all=o_subprocess_group.getTotalAlive()</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">#end while</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> oex:</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        o_traceback=sys.exc_info()[ 2 ]</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        s_err_info=pgut.get_traceback_info_about_offending_code( o_traceback )</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        s_prefix_msg_with_trace=<span class="stringliteral">&quot;Error caught by pgparallelopmanager, &quot;</span> \</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                + <span class="stringliteral">&quot;def __do_simulation_reps_in_subprocesses.&quot;</span> \</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                + <span class="stringliteral">&quot;\\nError origin info:\\n&quot;</span> \</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                + s_err_info </div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">if</span> b_use_gui_messaging:</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            pgut.show_error_in_messagebox_in_new_process( oex, </div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                s_msg_prefix = s_prefix_msg_with_trace )</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">#end if use gui messaging</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        s_msg=s_prefix_msg_with_trace + str( oex )</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">raise</span> Exception( oex )</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">#end try...except...</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">return</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">#end __do_simulation_reps_in_subprocesses</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="ttc" id="namespaceagestrucne_1_1pgparallelopmanager_html_a1b8e5b2e4146c4125cb06eb6aa8e5260"><div class="ttname"><a href="namespaceagestrucne_1_1pgparallelopmanager.html#a1b8e5b2e4146c4125cb06eb6aa8e5260">agestrucne.pgparallelopmanager.remove_simulation_replicate_output_files</a></div><div class="ttdeci">def remove_simulation_replicate_output_files(s_basename)</div><div class="ttdef"><b>Definition:</b> <a href="pgparallelopmanager_8py_source.html#l00473">pgparallelopmanager.py:473</a></div></div>
<div class="ttc" id="classagestrucne_1_1pgutilityclasses_1_1IndependantSubprocessGroup_html"><div class="ttname"><a href="classagestrucne_1_1pgutilityclasses_1_1IndependantSubprocessGroup.html">agestrucne.pgutilityclasses.IndependantSubprocessGroup</a></div><div class="ttdef"><b>Definition:</b> <a href="pgutilityclasses_8py_source.html#l00077">pgutilityclasses.py:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8100e801d32d6ecbb4e5bc2210d42022"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def agestrucne.pgparallelopmanager.prep_and_call_do_pgopsimupop_replicate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_config_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_life_table_files</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_param_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_output_base_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_replicate_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_use_gui_messaging</em> = <code>&quot;True&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_output_mode</em> = <code>str(&#160;pgsim.PGOpSimuPop.OUTPUT_GENEPOP_ONLY&#160;)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This def to be invoked in a subprocess.Popen command, as
instantiated in a PGGuiSimuPop instance in do_operation.

This def simply prepares the args for the call to def
do_pgopsimupop_replicate_from_files (below).

2017_05_30.  Added def parameter (string by necessity) s_use_gui_messaging with default
(bool-converted) value True, so that our new module pgdrivesimulation.py can call
this with this (bool-converted) value set to False, to avoid gui processing during
a command line execution.

2017_08_07.  Added def parameters s_output_mode and s_pop_het_filter_string, to
allows caller to use new output mode selections and het pop filter in PGOpSimuPop instances.

2017_09_04. Removed the het filter string from this def's arglist.  It will now
be stored in the input object only.
</pre> 
<p>Definition at line <a class="el" href="pgparallelopmanager_8py_source.html#l00047">47</a> of file <a class="el" href="pgparallelopmanager_8py_source.html">pgparallelopmanager.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="namespaceagestrucne_1_1pgparallelopmanager.html#a8100e801d32d6ecbb4e5bc2210d42022">   47</a></span>&#160;                                            s_output_mode=str( pgsim.PGOpSimuPop.OUTPUT_GENEPOP_ONLY ) ):</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="stringliteral">&#39;&#39;&#39; </span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="stringliteral">    This def to be invoked in a subprocess.Popen command, as</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="stringliteral">    instantiated in a PGGuiSimuPop instance in do_operation.</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="stringliteral">    This def simply prepares the args for the call to def</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="stringliteral">    do_pgopsimupop_replicate_from_files (below).</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="stringliteral">    2017_05_30.  Added def parameter (string by necessity) s_use_gui_messaging with default</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="stringliteral">    (bool-converted) value True, so that our new module pgdrivesimulation.py can call</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="stringliteral">    this with this (bool-converted) value set to False, to avoid gui processing during</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="stringliteral">    a command line execution.</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="stringliteral">    2017_08_07.  Added def parameters s_output_mode and s_pop_het_filter_string, to</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="stringliteral">    allows caller to use new output mode selections and het pop filter in PGOpSimuPop instances.</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="stringliteral">    2017_09_04. Removed the het filter string from this def&#39;s arglist.  It will now</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="stringliteral">    be stored in the input object only.</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">#de-stringify args for call to def below:</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    ls_life_table_files = s_life_table_files.split( pgut.DELIMITER_LIFE_TABLE_FILES )</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    i_replicate_number=int( s_replicate_number )</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    b_use_gui_messaging=<span class="keyword">True</span> <span class="keywordflow">if</span> s_use_gui_messaging==<span class="stringliteral">&quot;True&quot;</span> <span class="keywordflow">else</span> <span class="keyword">False</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    i_output_mode=int( s_output_mode )</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="namespaceagestrucne_1_1pgparallelopmanager.html#ad625c5f1bf0d410a2cd484c041cb3ab1">do_pgopsimupop_replicate_from_files</a>( s_config_file,</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                        ls_life_table_files,</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                        s_param_file,</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                        s_output_base_name,</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                        i_replicate_number,</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                        b_use_gui_messaging =  b_use_gui_messaging,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                        i_output_mode=i_output_mode )</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">return</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">#end prep_and_call_do_pgopsimupop_replicate</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="ttc" id="namespaceagestrucne_1_1pgparallelopmanager_html_ad625c5f1bf0d410a2cd484c041cb3ab1"><div class="ttname"><a href="namespaceagestrucne_1_1pgparallelopmanager.html#ad625c5f1bf0d410a2cd484c041cb3ab1">agestrucne.pgparallelopmanager.do_pgopsimupop_replicate_from_files</a></div><div class="ttdeci">def do_pgopsimupop_replicate_from_files(s_configuration_file, ls_life_table_files, s_param_name_file, s_outfile_basename, i_replicate_number, b_use_gui_messaging=True, i_output_mode=pgsim.PGOpSimuPop.OUTPUT_GENEPOP_ONLY)</div><div class="ttdef"><b>Definition:</b> <a href="pgparallelopmanager_8py_source.html#l00092">pgparallelopmanager.py:92</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1b8e5b2e4146c4125cb06eb6aa8e5260"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def agestrucne.pgparallelopmanager.remove_simulation_replicate_output_files </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_basename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">When a sim is cancelled inside a PGGuiSimuPop
object, this def is called
to remove any output files produced by the
do_pgopsimupop_replicate_from_files
</pre> 
<p>Definition at line <a class="el" href="pgparallelopmanager_8py_source.html#l00473">473</a> of file <a class="el" href="pgparallelopmanager_8py_source.html">pgparallelopmanager.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="namespaceagestrucne_1_1pgparallelopmanager.html#a1b8e5b2e4146c4125cb06eb6aa8e5260">  473</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespaceagestrucne_1_1pgparallelopmanager.html#a1b8e5b2e4146c4125cb06eb6aa8e5260">remove_simulation_replicate_output_files</a>( s_basename ):</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="stringliteral">    When a sim is cancelled inside a PGGuiSimuPop</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="stringliteral">    object, this def is called</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="stringliteral">    to remove any output files produced by the</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="stringliteral">    do_pgopsimupop_replicate_from_files</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">#type is to coerce python 3, despite fact that any iterable</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">#would probably suffice:</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    ls_output_extentions=list( \</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            pgout.PGOutputSimuPop.DICT_OUTPUT_FILE_EXTENSIONS.values() )</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="stringliteral">    2017_05_16. Added to remove the recently added age counts and </span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="stringliteral">    PWOP Nb estimates files created on rep 1 in the simulations.</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="stringliteral">    These files don&#39;t have replicate tags in their names, </span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="stringliteral">    so our glob should not include one.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    s_age_counts_ext=pgout.PGOutputSimuPop.DICT_OUTPUT_FILE_EXTENSIONS[ <span class="stringliteral">&quot;age_counts&quot;</span> ]</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    s_sim_nb_vals_ext=pgout.PGOutputSimuPop.DICT_OUTPUT_FILE_EXTENSIONS[ <span class="stringliteral">&quot;sim_nb_estimates&quot;</span> ]</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="stringliteral">    2018_04_01.  We have added the replicate number to both the</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="stringliteral">    age_counts and the sim_nb_estimates files, so we rem this out</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="stringliteral">    and leave the non-rep ext list empty</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="stringliteral">    &#39;&#39;&#39;</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">#ls_non_replicate_extensions=[ s_age_counts_ext, s_sim_nb_vals_ext ]</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    ls_non_replicate_extensions=[]</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">for</span> s_ext <span class="keywordflow">in</span> ls_output_extentions:</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        s_unzipped_file_pattern=<span class="keywordtype">None</span>    </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> s_ext <span class="keywordflow">in</span> ls_non_replicate_extensions:</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            s_unzipped_file_pattern=s_basename + s_ext</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            s_unzipped_file_pattern=s_basename + <span class="stringliteral">&quot;*&quot;</span> \</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    + pgut.SIMULATION_OUTPUT_FILE_REPLICATE_TAG \</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                    + <span class="stringliteral">&quot;*&quot;</span> + s_ext</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">#end if  non-replicate file name, else use replicate tag    </span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        ls_files_unzipped=glob.glob( s_unzipped_file_pattern )</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        ls_files_zipped=glob.glob( s_unzipped_file_pattern \</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                + <span class="stringliteral">&quot;.&quot;</span> + pgout.PGOutputSimuPop.COMPRESSION_FILE_EXTENSION )</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">for</span> s_file <span class="keywordflow">in</span> ls_files_unzipped + ls_files_zipped:</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            os.remove( s_file )</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="comment">#end for each unzipped and zipped output file with this extension</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">#end for each file ext</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">return</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">#end remove_simulation_replicate_output_files</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="ttc" id="namespaceagestrucne_1_1pgparallelopmanager_html_a1b8e5b2e4146c4125cb06eb6aa8e5260"><div class="ttname"><a href="namespaceagestrucne_1_1pgparallelopmanager.html#a1b8e5b2e4146c4125cb06eb6aa8e5260">agestrucne.pgparallelopmanager.remove_simulation_replicate_output_files</a></div><div class="ttdeci">def remove_simulation_replicate_output_files(s_basename)</div><div class="ttdef"><b>Definition:</b> <a href="pgparallelopmanager_8py_source.html#l00473">pgparallelopmanager.py:473</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
