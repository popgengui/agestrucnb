<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AgeStrucNe: agestrucne.genepopfilesampler.GenepopFileSamplerCohorts Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AgeStrucNe
   </div>
   <div id="projectbrief">GUI Front end with refactoring of population genetics programming provided by Tiago Antao&#39;s AgeStructureNe code, with enhanced subsampling, simulation parameterization, and plotting.  We have several outside dependancies (chiefly simuPop and LDNe2)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>agestrucne</b></li><li class="navelem"><a class="el" href="namespaceagestrucne_1_1genepopfilesampler.html">genepopfilesampler</a></li><li class="navelem"><a class="el" href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html">GenepopFileSamplerCohorts</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">agestrucne.genepopfilesampler.GenepopFileSamplerCohorts Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for agestrucne.genepopfilesampler.GenepopFileSamplerCohorts:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.png" usemap="#agestrucne.genepopfilesampler.GenepopFileSamplerCohorts_map" alt=""/>
  <map id="agestrucne.genepopfilesampler.GenepopFileSamplerCohorts_map" name="agestrucne.genepopfilesampler.GenepopFileSamplerCohorts_map">
<area href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSampler.html" alt="agestrucne.genepopfilesampler.GenepopFileSampler" shape="rect" coords="0,56,355,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a20733917b0501b345f8dd4c941a8b88f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20733917b0501b345f8dd4c941a8b88f"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b> (self, o_genepopfilemanager, o_genepopfilesampleparams)</td></tr>
<tr class="separator:a20733917b0501b345f8dd4c941a8b88f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac474abc0e3189c913e49a2aee377dc7d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#ac474abc0e3189c913e49a2aee377dc7d">resize_sample_to_meet_size_criteria</a> (self, li_indiv_by_age_collected)</td></tr>
<tr class="separator:ac474abc0e3189c913e49a2aee377dc7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f7c18db2040436ff13f10fffdaad5d8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#a8f7c18db2040436ff13f10fffdaad5d8">doSample</a> (self)</td></tr>
<tr class="separator:a8f7c18db2040436ff13f10fffdaad5d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classagestrucne_1_1genepopfilesampler_1_1GenepopFileSampler"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classagestrucne_1_1genepopfilesampler_1_1GenepopFileSampler')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSampler.html">agestrucne.genepopfilesampler.GenepopFileSampler</a></td></tr>
<tr class="memitem:ac1c0ed4839d77f7a5aa58698358c88c1 inherit pub_methods_classagestrucne_1_1genepopfilesampler_1_1GenepopFileSampler"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac1c0ed4839d77f7a5aa58698358c88c1"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b> (self, o_genepopfilemanager, o_genepopfilesampleparams)</td></tr>
<tr class="separator:ac1c0ed4839d77f7a5aa58698358c88c1 inherit pub_methods_classagestrucne_1_1genepopfilesampler_1_1GenepopFileSampler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df488c79af5edb9db5d817540babdd2 inherit pub_methods_classagestrucne_1_1genepopfilesampler_1_1GenepopFileSampler"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1df488c79af5edb9db5d817540babdd2"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>filemanager</b> (self)</td></tr>
<tr class="separator:a1df488c79af5edb9db5d817540babdd2 inherit pub_methods_classagestrucne_1_1genepopfilesampler_1_1GenepopFileSampler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad87793572a885a4bae1f4c62890252f2 inherit pub_methods_classagestrucne_1_1genepopfilesampler_1_1GenepopFileSampler"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad87793572a885a4bae1f4c62890252f2"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>sampleparams</b> (self)</td></tr>
<tr class="separator:ad87793572a885a4bae1f4c62890252f2 inherit pub_methods_classagestrucne_1_1genepopfilesampler_1_1GenepopFileSampler"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">This sampler class is meant to implement Tiago's sampling code in his
sampleIndivsCohort.py module.  It samples  individuals grouped by age.
The GenepopFileSampleParams object used by instances
of this class has the values Tiagos module takes at the command line 
that restrict the total individuals per gen.  His command line params 
startGen and endGen paramters are already implemented via the Sampler's
li_population_numbers parameter.


2017_07_21.  This class is copied from original version named class
GenepopFileSamplerIndividualsAgeStructureCohorts, and revised to 
handle subsample values using the (new class) GenepopFileSampleParamsCohorts,
which will store lists of proportions and/or indiv count limits.  Further,
this class will use these values (if present) to subsample the already
evenly sampled age classes 0,1...max_age, again, evenly across the age classes.
Note that before this revision, the only subsampling applied (proportion,
via class GenepopFileSamplerIndividualsAgeStructureCohortsPercentage),
sampled a proportion of the pooled age classes, so that the final sample,
if representing multiple age classes, was likely biased towards/against 
one or another across age class).
</pre> 
<p>Definition at line <a class="el" href="genepopfilesampler_8py_source.html#l00813">813</a> of file <a class="el" href="genepopfilesampler_8py_source.html">genepopfilesampler.py</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a8f7c18db2040436ff13f10fffdaad5d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def agestrucne.genepopfilesampler.GenepopFileSamplerCohorts.doSample </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Sample identical numbers per age, then reduce to meet max indiv per gen or proportion.  
See Tiagos code in his sampleIndivsCohort.py module.  Note that when param 
"lp" is included, then Tiagos code adds to his lines that print out, gen_number\sindiv, 
the same lines without a gen number, presumably for downstream filtering when making the final
genenpop file. As of 2016_09_12, the output when the "lp" arg is added, is not 
implemented.

2017_07_21. For this revised version of original class 
GenepopFileSamplerIndividualsAgeStructureCohorts, we use the member of new 
class GenepopFileSampleParamsCohorts, list_of_sampling_values, to loop over
proportion (or count--not yet implemented) subsample values (if any), and 
add a pop subsample tag for each value.  This is an incorporation of the 
original doSample, with the looping logic of the doSample in the original
class GenepopFileSamplerIndividualsAgeStructureCohortsPercentage.
</pre> 
<p>Definition at line <a class="el" href="genepopfilesampler_8py_source.html#l00972">972</a> of file <a class="el" href="genepopfilesampler_8py_source.html">genepopfilesampler.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00972"></a><span class="lineno"><a class="line" href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#a8f7c18db2040436ff13f10fffdaad5d8">  972</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#a8f7c18db2040436ff13f10fffdaad5d8">doSample</a>( self ):</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="stringliteral">        Sample identical numbers per age, then reduce to meet max indiv per gen or proportion.  </span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="stringliteral">        See Tiagos code in his sampleIndivsCohort.py module.  Note that when param </span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="stringliteral">        &quot;lp&quot; is included, then Tiagos code adds to his lines that print out, gen_number\sindiv, </span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="stringliteral">        the same lines without a gen number, presumably for downstream filtering when making the final</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="stringliteral">        genenpop file. As of 2016_09_12, the output when the &quot;lp&quot; arg is added, is not </span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="stringliteral">        implemented.</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="stringliteral">        2017_07_21. For this revised version of original class </span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="stringliteral">        GenepopFileSamplerIndividualsAgeStructureCohorts, we use the member of new </span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="stringliteral">        class GenepopFileSampleParamsCohorts, list_of_sampling_values, to loop over</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="stringliteral">        proportion (or count--not yet implemented) subsample values (if any), and </span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="stringliteral">        add a pop subsample tag for each value.  This is an incorporation of the </span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="stringliteral">        original doSample, with the looping logic of the doSample in the original</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="stringliteral">        class GenepopFileSamplerIndividualsAgeStructureCohortsPercentage.</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="stringliteral">        &#39;&#39;&#39;</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="comment">#estimator driver needs a pop number subsample when it adds calls to the NeEstimator:</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        self.filemanager.subsamplePopulationsByList( self.sampleparams.population_numbers,</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                        s_subsample_tag=self.sampleparams.population_subsample_name )</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        FIELD_NAME_AGE=<span class="stringliteral">&quot;age&quot;</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="stringliteral">        If we are processing a session with No </span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="stringliteral">        subsampling values, we will pass self.__get_individuals</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="stringliteral">        &quot;None&quot;</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="stringliteral">        &#39;&#39;&#39;</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        lo_sampling_value_objects_list=[ <span class="keywordtype">None</span> ]</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">if</span> self.sampleparams.list_of_sampling_values <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            lo_sampling_value_objects_list=self.sampleparams.list_of_sampling_values</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="comment">#end if no samping value (i.e. schem is &quot;none&quot;) else we have them</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">for</span> o_sampling_value_object <span class="keywordflow">in</span> lo_sampling_value_objects_list:</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            </div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            dli_indiv_index_lists_by_pop_number={}</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            </div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            i_replicate_count=self.sampleparams.replicates</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keywordflow">for</span> i_replicate_number <span class="keywordflow">in</span> range( i_replicate_count ):</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                <span class="keywordflow">for</span> i_pop_number <span class="keywordflow">in</span> self.sampleparams.population_numbers:</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    ls_id_list=self.filemanager.getListIndividuals( i_pop_number )</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="stringliteral">                    We assume that the list of Id&#39;s in the individual list</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="stringliteral">                    is indexed such that the zeroth id corresponds to the first</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="stringliteral">                    indiv as ordered in the genepop file, the [1] indexed id</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="stringliteral">                    is the second indiv, etc.</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="stringliteral">                    &#39;&#39;&#39;</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                    i_tot_indiv=len( ls_id_list )</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                    dli_indiv_index_by_age={}</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                    </div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                    <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> range( i_tot_indiv ):</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                        s_id=ls_id_list[ idx ]</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                        o_id_vals=<a class="code" href="classagestrucne_1_1genepopindividualid_1_1GenepopIndivIdVals.html">GenepopIndivIdVals</a>( s_id, </div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                            self.sampleparams.fields )</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                        </div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                        <span class="comment">#age may be float or int:</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                        v_age=o_id_vals.getVal( FIELD_NAME_AGE )</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                        <span class="keywordflow">if</span> v_age &gt; self.sampleparams.max_age:</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                            <span class="keywordflow">continue</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                        <span class="comment">#end if too old, continue</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                        <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="stringliteral">                        Note that idx+1 gives the number of the individual as ordered by its</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="stringliteral">                        entry in the &quot;pop&quot; section of this pop in the genepop file, as used</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="stringliteral">                        by the genepopfilemanager object to point to it&#39;s byte address in the file.</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="stringliteral">                        Thus it&#39;s our way of collecting samples of individuals and passing them into the</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="stringliteral">                        genepop file manager object&#39;s subsampling records (its attribute </span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="stringliteral">                        __indiv_subsamples).</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="stringliteral">                        &#39;&#39;&#39;</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                        i_indiv_number=idx+1</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                        dli_indiv_index_by_age.setdefault( \</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                    v_age, [] ).append( i_indiv_number ) </div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                    <span class="comment">#end for each individual&#39;s id   </span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                    li_indiv_by_age_collected=self.<a class="code" href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#a019deb3e20beaa1043482a2842aa173f">__get_individuals</a>( \</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                                                    dli_indiv_index_by_age,</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                                                    o_sampling_value_object ) </div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                </div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                    <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="stringliteral">                    2017_07_21.  We note that, for now, this call will simply throw </span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="stringliteral">                    an error if the current sample (pooled individuals from all age classes,</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="stringliteral">                    with any proportion or count subsample value also applied,</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="stringliteral">                    &#39;&#39;&#39;</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                    li_indiv_by_age_sampled=self.<a class="code" href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#ac474abc0e3189c913e49a2aee377dc7d">resize_sample_to_meet_size_criteria</a>( </div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                                                li_indiv_by_age_collected ) </div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                    <span class="comment">#We rely on the genpopfilemanager object to sort </span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                    <span class="comment">#these indices when we pass them to the def,</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                    <span class="comment">#subsampleIndividualsByNumberList (see below).</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                    dli_indiv_index_lists_by_pop_number[ i_pop_number ] = \</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                                        li_indiv_by_age_sampled</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                <span class="comment">#end for each pop number</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <span class="keywordflow">if</span> o_sampling_value_object <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                    self.sampleparams.sample_param_value=\</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                            str( o_sampling_value_object.sampling_value )</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                <span class="comment">#end if we have a sampling value</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                </div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                s_this_subsample_name=make_subsample_tag( \</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                                    self.sampleparams.sample_param_value, </div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                    i_replicate_number, </div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                    SCHEME_COHORTS,</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                    s_prefix=self.sampleparams.sample_tag_base )</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                </div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                self.filemanager.subsampleIndividualsByNumberList( \</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                        dli_indiv_index_lists_by_pop_number,</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                        s_this_subsample_name )</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <span class="comment">#end for each replicate</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <span class="comment">#end for each  sampling value</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="keywordflow">return</span></div><div class="ttc" id="classagestrucne_1_1genepopindividualid_1_1GenepopIndivIdVals_html"><div class="ttname"><a href="classagestrucne_1_1genepopindividualid_1_1GenepopIndivIdVals.html">agestrucne.genepopindividualid.GenepopIndivIdVals</a></div><div class="ttdef"><b>Definition:</b> <a href="genepopindividualid_8py_source.html#l00158">genepopindividualid.py:158</a></div></div>
<div class="ttc" id="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts_html_a019deb3e20beaa1043482a2842aa173f"><div class="ttname"><a href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#a019deb3e20beaa1043482a2842aa173f">agestrucne.genepopfilesampler.GenepopFileSamplerCohorts.__get_individuals</a></div><div class="ttdeci">def __get_individuals(self, dli_indiv_index_by_age, o_sample_value_object=None)</div><div class="ttdef"><b>Definition:</b> <a href="genepopfilesampler_8py_source.html#l00844">genepopfilesampler.py:844</a></div></div>
<div class="ttc" id="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts_html_ac474abc0e3189c913e49a2aee377dc7d"><div class="ttname"><a href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#ac474abc0e3189c913e49a2aee377dc7d">agestrucne.genepopfilesampler.GenepopFileSamplerCohorts.resize_sample_to_meet_size_criteria</a></div><div class="ttdeci">def resize_sample_to_meet_size_criteria(self, li_indiv_by_age_collected)</div><div class="ttdef"><b>Definition:</b> <a href="genepopfilesampler_8py_source.html#l00921">genepopfilesampler.py:921</a></div></div>
<div class="ttc" id="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts_html_a8f7c18db2040436ff13f10fffdaad5d8"><div class="ttname"><a href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#a8f7c18db2040436ff13f10fffdaad5d8">agestrucne.genepopfilesampler.GenepopFileSamplerCohorts.doSample</a></div><div class="ttdeci">def doSample(self)</div><div class="ttdef"><b>Definition:</b> <a href="genepopfilesampler_8py_source.html#l00972">genepopfilesampler.py:972</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac474abc0e3189c913e49a2aee377dc7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def agestrucne.genepopfilesampler.GenepopFileSamplerCohorts.resize_sample_to_meet_size_criteria </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>li_indiv_by_age_collected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Given the individuals collected by age, 
check min/max limits and subsample
if needed.  If within limits, return
the original list
</pre> 
<p>Definition at line <a class="el" href="genepopfilesampler_8py_source.html#l00921">921</a> of file <a class="el" href="genepopfilesampler_8py_source.html">genepopfilesampler.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00921"></a><span class="lineno"><a class="line" href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#ac474abc0e3189c913e49a2aee377dc7d">  921</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#ac474abc0e3189c913e49a2aee377dc7d">resize_sample_to_meet_size_criteria</a>( self, li_indiv_by_age_collected ):</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="stringliteral">&#39;&#39;&#39;</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="stringliteral">        Given the individuals collected by age, </span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="stringliteral">        check min/max limits and subsample</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="stringliteral">        if needed.  If within limits, return</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="stringliteral">        the original list</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="stringliteral">        &#39;&#39;&#39;</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment">#If too few we raise an error.  If too many we</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="comment">#randomly select to reach our max valid pop size</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        i_tot_collected=len( li_indiv_by_age_collected )</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        li_indiv_by_age_sampled=<span class="keywordtype">None</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="keywordflow">if</span> i_tot_collected &lt; self.sampleparams.min_indiv_per_gen:</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            s_msg=<span class="stringliteral">&quot;In GenepopFileSamplerIndividualsAgeStructureCohorts instance, &quot;</span> \</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                    <span class="stringliteral">&quot;after sampling cohorts, total collected, &quot;</span> \</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                    + str( i_tot_collected ) \</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                    + <span class="stringliteral">&quot;, is less than the value given for &quot;</span> \</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                    + <span class="stringliteral">&quot;the minimum pop size, &quot;</span> \</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                    + str( self.sampleparams.min_indiv_per_gen ) \</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                    + <span class="stringliteral">&quot;.&quot;</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="keywordflow">raise</span> Exception ( s_msg )</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">elif</span> i_tot_collected &gt; self.sampleparams.max_indiv_per_gen:</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                li_indiv_by_age_sampled=random.sample( \</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                    li_indiv_by_age_collected,</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                    self.sampleparams.max_indiv_per_gen )</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                        </div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> oex:</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                s_sample_error_msg= \</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                    <span class="stringliteral">&quot;In GenepopFileSamplerIndividualsAgeStructureCohorts &quot;</span> \</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                        + <span class="stringliteral">&quot;instance, def resize_sample_to_meet_size_criteria, &quot;</span>  \</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                        + <span class="stringliteral">&quot;random.sample failed on list of &quot;</span> \</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                        + str( len( li_indiv_by_age_collected ) ) \</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                        + <span class="stringliteral">&quot; individuals.  Target total to be sampled: &quot;</span> \</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                        + str( self.sampleparams.max_indiv_per_gen ) + <span class="stringliteral">&quot;.&quot;</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                s_msg=s_sample_error_msg \</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                        + <span class="stringliteral">&quot;  Exception message: &quot;</span> + str( oex ) + <span class="stringliteral">&quot;.&quot;</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                <span class="keywordflow">raise</span> Exception( s_msg )</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="comment">#end try . . . except</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <span class="comment">#within interval min to max pop size, so keep original </span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            li_indiv_by_age_sampled=li_indiv_by_age_collected</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="comment">#end if too few, error, else if too many, sample, else no change</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordflow">return</span> li_indiv_by_age_sampled</div><div class="ttc" id="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts_html_ac474abc0e3189c913e49a2aee377dc7d"><div class="ttname"><a href="classagestrucne_1_1genepopfilesampler_1_1GenepopFileSamplerCohorts.html#ac474abc0e3189c913e49a2aee377dc7d">agestrucne.genepopfilesampler.GenepopFileSamplerCohorts.resize_sample_to_meet_size_criteria</a></div><div class="ttdeci">def resize_sample_to_meet_size_criteria(self, li_indiv_by_age_collected)</div><div class="ttdef"><b>Definition:</b> <a href="genepopfilesampler_8py_source.html#l00921">genepopfilesampler.py:921</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>agestrucne/<a class="el" href="genepopfilesampler_8py_source.html">genepopfilesampler.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
